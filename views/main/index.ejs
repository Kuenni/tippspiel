<script src="//d3js.org/d3.v3.min.js" charset="utf-8"></script>
<body ng-app="mainPageApp">
	<div class="container-fluid" ng-controller="MainPageController">
		<div id="loginFields" class="col-md-6 col-md-offset-3" ng-if="!loggedIn">
			<div id='loginLabel' class="col-md-offset-3">
				<h2><span class="label label-warning">Bitte eingeloggen!</span></h2>
			</div>
			<form class="form-inline" id="login-form">
				<div class="form-group">
					<label for="loginName">Name</label>
					<input type="text" id="loginName" placeholder="name" class="form-control" />
				</div>
				<div class="form-group">
					<label for="loginPassword">Password</label>
					<input type="password" id="loginPassword" placeholder="password" class="form-control" />
				</div>
				<button type="submit" class="btn btn-primary" ng-click="login()">
					Login
				</button>
			</form>
		</div>
		<div id="selectorsDiv" class="col-md-2 col-md-offset-5">
			<span ng-if="loggedIn" id="seasonSelectDiv"> Saison:
				<select ng-model="$parent.selectedSeason">
					<option value="" disabled>---Bitte  w&auml;hlen---</option>
					<option ng-repeat="season in seasons" value="{{season.id}}" ng-click="getCurrentMatchday()"> {{season.seasonName}} </option>
					<option ng-click="addSeason()" value=""> Saison hinzuf&uuml;gen...</option>
				</select> </span>
			<span id="matchdaySelectDiv" ng-if="selectedSeason" ng-init="false" > Spieltag:
				<select ng-options="day.name for day in matchdays" ng-model="$parent.selectedMatchday"
				ng-change="printSelectedMatchday()" >
					<option disabled value="">---Bitte  w&auml;hlen---</option>
				</select> </span>
		</div>
		<div id="betsDiv" ng-if="selectedSeason" ng-init="false">
			<div id="tableContainer" class="col-md-10 col-md-offset-1">
				<div id="storeButtons" class="col-md-2 col-md-offset-10 text-right">
					<button class="btn btn-sm btn-success" ng-click="storeUpdates()" >
						Speichern
					</button>
					<button type="button" class="btn btn-info btn-sm text-right" ng-click="refresh()">
						<span class="glyphicon glyphicon-refresh" aria-hidden="true"></span>
					</button>
				</div>
				<div id="resultsTable">
					<table class="table table-striped table-hover">
						<thead>
							<th></th>
							<th>Heim</th>
							<th></th>
							<th>Gast</th>
							<th class="text-center col-xs-1">Tore Heim</th>
							<th></th>
							<th class="text-center col-xs-1">Tore Gast</th>
							<th></th>
							<th class="text-center col-sm-1">Ergebnis Heim</th>
							<th></th>
							<th class="text-center col-sm-1">Ergebnis Gast</th>
							<th></th>
							<th class="text-center col-xs-1">Punkte</th>
						</thead>
						<tr ng-repeat="bet in bets" data-ng-class="{success: bet.cachedPoints==5, warning: bet.betHome == -1 || bet.betGuest == -1}">
							<td><img src={{bet.logoTeamHome}}></td>
							<td>{{bet.teamhome}}</td>
							<td><img src={{bet.logoTeamGuest}}></td>
							<td>{{bet.teamguest}}</td>
							<td>
							<input type="text" class="text-center form-control" ng-model="bet.betHome"/>
							</td>
							<td class="text-center">:</td>
							<td>
							<input type="text" class="text-center form-control" ng-model="bet.betGuest"/>
							</td>
							<td></td>
							<td class="text-center"> {{bet.cachedGoalsHome}} </td>
							<td class="text-center">:</td>
							<td class="text-center"> {{bet.cachedGoalsGuest}} </td>
							<td></td>
							<td class="text-center">{{bet.cachedPoints}}</td>
						</tr>
					</table>
				</div>
			</div>
			<div id="userRanking" class="col-md-10 col-md-offset-1">
				<table class="table table-striped table-hover">
					<thead>
						<th>User</th>
						<th class="text-center">Correct</th>
						<th class="text-center">Difference</th>
						<th class="text-center">Tendency</th>
						<th class="text-center">Total Points</th>
					</thead>
					<tr ng-repeat="item in users | orderBy:'-points'">
						<td>{{item.username}}</td>
						<td class="text-center">{{item.nCorrect}}</td>
						<td class="text-center">{{item.nDiff}}</td>
						<td class="text-center">{{item.nTrend}}</td>
						<td class="text-center">{{item.points}}</td>
					</tr>
				</table>
			</div>
			<div id="teamRanking" class="col-md-10 col-md-offset-1">
				<table class="table table-striped table-hover">
					<thead>
						<th class="name"><a ng-click="sort_by('name')">Team <i class="fa fa-sort"></i></a></th>
						<th class="text-center"><a ng-click="sort_by('wins')">Won <i class="fa fa-sort"></i></a></th>
						<th class="text-center"><a ng-click="sort_by('draws')">Draw <i class="fa fa-sort"></i></a></th>
						<th class="text-center"><a ng-click="sort_by('losses')">Lost <i class="fa fa-sort"></i></a></th>
						<th class="text-center"><a ng-click="sort_by('points')">Total Points <i class="fa fa-sort"></i></a></th>
					</thead>
					<tr ng-repeat="item in teams | orderBy:sortingOrder:reverse">
						<td>{{item.name}}</td>
						<td class="text-center">{{item.wins}}</td>
						<td class="text-center">{{item.draws}}</td>
						<td class="text-center">{{item.losses}}</td>
						<td class="text-center">{{item.points}}</td>
					</tr>
				</table>
			</div>
		</div>
		<div id="usertimeline" class="col-md-10 col-md-offset-1" >
				<svg class="chart" id="timeline"></svg>
		</div>
	</div>
</body>
